# Проект посвящен решению задачи регрессии при помощи моделей машинного обучения и ансамбля моделей

## Описание проекта:
1. **EDA анализ.**
2. **Предварительная обработка данных.**
3. **Решению задачи регрессии при помощи моделей машинного обучения, составление ансамбля моделей.**
4. **Решение задачи поиска аномалий.**
5. **Визуализация - графики ошибок прогнозирования, метрик качества обученной модели и важности признаков.**

### Модули проекта:
1. **Загрузка и чтение данных (data_loader.py):**
   Модуль загружает данные из различных источников в зависимости от расширения файла или типа пути: 
   - Определяет расширение файла,
   - Если файл имеет расширение .csv - пытается загрузить CSV файл с кодировкой ISO-8859-1. Если возникает ошибка UnicodeDecodeError, загружает файл с кодировкой utf-8, игнорируя ошибки.
   - Если файл имеет расширение .json - открывает JSON файл и загружает его содержимое.
   - Если путь содержит api - выполняет GET запрос к указанному API и возвращает текст ответа.
   - Если формат файла не поддерживается- - выводит сообщение о неподдерживаемом формате файла и возвращает None.

2. **Анализ качества данных (data_analysis.py):**
  Модуль выполняет несколько функций для анализа и обработки данных в DataFrame:
   - Подсчет пропущенных значений (функция count_missing_values(df) подсчитывает количество и процент пропущенных значений для каждого столбца и возвращает результаты в виде словаря).
   - Определение типов данных (функция get_data_types(df) возвращает информацию о типах данных в каждом столбце в виде словаря).
   - Описание датасета (функция describe_dataset(df) описывает датасет, включая количество строк и столбцов, количество уникальных значений, пропущенные значения, типы данных и использование памяти).
   - Генерация отчета о датасете (функция report_on_dataset(df) генерирует подробный отчет о датасете, включая типы данных, пропущенные значения и основные статистики).

3. **Предобработка данных (data_preprocessing.py):**
  Этот модуль выполняет предварительную обработку данных, а именно:
  - Определение столбцов с пропущенными значениями.
  - Заполнение пропущенных значений (Для числовых столбцов пропущенные значения заменяются на средние значения.
Для категориальных столбцов пропущенные значения заменяются на наиболее часто встречающиеся значения (моду).

4. **Анализ распределения данных (analyze_distribution.py):**
  Модуль выполняет анализ распределения данных в датасете. Он включает следующие шаги:
  - Определение числовых и категориальных признаков.
  - Построение гистограмм для числовых признаков.
  - Построение pairplot для числовых признаков с учетом переменной Potability.
  - Построение корреляционной тепловой карты для числовых признаков.
  - Построение boxplot для числовых признаков с учетом переменной Potability.

5. **Модуль model_training.py выполняет следующие задачи:**
  - Разделение данных (делит данные на признаки (X) и целевую переменную (y).
  - Разделение на обучающую и тестовую выборки (разделяет данные на обучающую и тестовую выборки с использованием train_test_split).
  - Масштабирование данных с помощью StandardScaler.
  - Определение моделей и гиперпараметров (определяет несколько моделей машинного обучения и их гиперпараметры для настройки).
  - Обучение и оценка моделей (выполняет обучение и оценку моделей с использованием GridSearchCV для подбора лучших гиперпараметров, сохраняет лучшие модели и их предсказания, вычисляет метрики для каждой модели).
  - Обнаружение аномалий (выполняет обнаружение аномалий и выбросов для каждой модели).
  - Визуализация остатков (визуализирует остатки (разница между фактическими и предсказанными значениями) для каждой модели).
  - Ансамбль моделей (создает ансамбль моделей путем усреднения предсказаний лучших моделей, вычисляет метрики MAE, MSE, RMSE и R2 для ансамбля, выполняет обнаружение аномалий и визуализацию остатков для ансамбля).
  - Визуализация результатов (визуализирует фактические и предсказанные значения, метрики моделей и важность признаков).
  - Возвращение результатов оценки моделей.

6. **Модуль обнаружения аномалий и выбросов (anomaly.py):**

7. **Модуль функций для визуализации результатов моделей машинного обучения (train_and_evaluate_plot_metrics.py):**
- Функция plot_actual_vs_predicted(y_test, y_preds) визуализирует фактические и предсказанные значения для каждой модели.
- Функция plot_scores(results) визуализирует метрики MAE, MSE, RMSE и R2 для каждой модели.
- Функция plot_feature_importances(best_estimators, X) визуализирует важность признаков для каждой модели.
- Функция plot_residuals(y_test, y_preds) визуализирует остатки (разница между фактическими и предсказанными значениями) для каждой модели.


### Описание данных

В проекте использовался датасет Water Quality (Drinking water potability).
Ссылка на датасет: https://www.kaggle.com/datasets/adityakadiwal/water-potability/data?select=water_potability.csv

Датасет содержит следующие признаки:
- **pH value - значение pH.**
- **Hardness - твердость.**
- **Solids (Total dissolved solids - TDS) - общее количество растворенных твердых веществ.**
- **Chloramines - хлорамины).**
- **Sulfate - сульфат.**
- **Conductivity - проводимость).**
- **Organic_carbon - органический углерод).**
- **Trihalomethanes - тригалометаны).**
- **Turbidity - мутность.**
- **Potability - пригодность воды для питья - указывает, безопасна ли вода для потребления человеком^ 1 означает, что ее можно пить, а 0 означает, что пить небезопасно.**

### Структура проекта
- `main.ipynb`
- `data_loader.py`
- `data_analysis.py`
- `data_preprocessing.py`
- `analyze_distribution.py`
- `model_training.py`
- `anomaly.py`
- `train_and_evaluate_plot_metrics.py`

